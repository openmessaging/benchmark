[
  {
    "name": "full-encrypt",
    "pluginClass": "io.conduktor.gateway.interceptor.EncryptPlugin",
    "priority": 100,
    "config": {
      "topic": "full-encrypt.*",
      "kmsConfig": {
        "aws": {
          "basicCredentials": {
            "accessKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_ACCESS_KEY') }}",
            "secretKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_SECRET_KEY') }}"
          }
        }
      },
      "recordValue": {
        "payload": {
          "keySecretId": "aws-kms://{{ tf_kms_arn }}",
          "algorithm": "AES128_GCM"
        }
      }
    }
  },
  {
    "name": "full-decrypt",
    "pluginClass": "io.conduktor.gateway.interceptor.DecryptPlugin",
    "priority": 100,
    "config": {
      "topic": "full-encrypt.*",
      "kmsConfig": {
        "aws": {
          "basicCredentials": {
            "accessKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_ACCESS_KEY') }}",
            "secretKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_SECRET_KEY') }}"
          }
        }
      }
    }
  },
  {
    "name": "gatewaykms-full-encrypt",
    "pluginClass": "io.conduktor.gateway.interceptor.EncryptPlugin",
    "priority": 100,
    "config": {
      "topic": "gatewaykms-fe.*",
      "recordValue": {
        "payload": {
          "keySecretId": "gateway-kms://fe-username-{{record.key}}",
          "algorithm": "AES128_GCM"
        }
      },
      "kmsConfig": {
        "aws": {
          "basicCredentials": {
            "accessKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_ACCESS_KEY') }}",
            "secretKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_SECRET_KEY') }}"
          }
        },
        "gateway": {
          "masterKeyId": "aws-kms://{{ tf_kms_arn }}",
          "maxKeys" : 10000000
        }
      }
    }
  },
  {
    "name": "gatewaykms-full-decrypt",
    "pluginClass": "io.conduktor.gateway.interceptor.DecryptPlugin",
    "priority": 100,
    "config": {
      "topic": "gatewaykms-fe.*",
      "kmsConfig": {
        "aws": {
          "basicCredentials": {
            "accessKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_ACCESS_KEY') }}",
            "secretKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_SECRET_KEY') }}"
          }
        },
        "gateway": {
          "masterKeyId": "aws-kms://{{ tf_kms_arn }}",
          "maxKeys" : 10000000
        }
      }
    }
  },
  {
    "name": "gatewaykms-field-level-encrypt",
    "pluginClass": "io.conduktor.gateway.interceptor.EncryptPlugin",
    "priority": 100,
    "config": {
      "topic": "gatewaykms-fle.*",
      "recordValue": {
        "fields": [
          {
            "fieldName": "password",
            "keySecretId": "gateway-kms://fle-username-{{record.key}}",
            "algorithm": "AES128_GCM"
          },
          {
            "fieldName": "visa",
            "keySecretId": "gateway-kms://fle-username-{{record.key}}",
            "algorithm": "AES128_GCM"
          },
          {
            "fieldName": "mobile",
            "keySecretId": "gateway-kms://fle-username-{{record.key}}",
            "algorithm": "AES128_GCM"
          }
        ]
      },
      "kmsConfig": {
        "aws": {
          "basicCredentials": {
            "accessKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_ACCESS_KEY') }}",
            "secretKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_SECRET_KEY') }}"
          }
        },
        "gateway": {
          "masterKeyId": "aws-kms://{{ tf_kms_arn }}",
          "maxKeys" : 10000000
        }
      }
    }
  },
  {
    "name": "gatewaykms-field-level-decrypt",
    "pluginClass": "io.conduktor.gateway.interceptor.DecryptPlugin",
    "priority": 100,
    "config": {
      "topic": "gatewaykms-fle.*",
      "kmsConfig": {
        "aws": {
          "basicCredentials": {
            "accessKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_ACCESS_KEY') }}",
            "secretKey": "{{ lookup('ansible.builtin.env', 'ENCRYPT_SECRET_KEY') }}"
          }
        },
        "gateway": {
          "masterKeyId": "aws-kms://{{ tf_kms_arn }}",
          "maxKeys" : 10000000
        }
      }
    }
  }
]
